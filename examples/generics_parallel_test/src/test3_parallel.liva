// Test 3: Parallel array operations
// Testing par.map (which works), documenting bugs for filter/reduce

main() {
    print("=== Parallel Map Test ===")
    let nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    
    // Regular map
    let doubled = nums.map(x => x * 2)
    print($"Regular map (doubled): {doubled}")
    
    // Parallel map - this works!
    let parallelDoubled = nums.par().map(x => x * 2)
    print($"Parallel map (doubled): {parallelDoubled}")
    
    // Parallel map with larger computation
    let squared = nums.par().map(x => x * x)
    print($"Parallel map (squared): {squared}")
    
    // Parallel map with expression
    let cubed = nums.par().map(x => x * x * x)
    print($"Parallel map (cubed): {cubed}")
    
    print("\n=== Regular Reduce ===")
    let values = [1, 2, 3, 4, 5]
    
    // Regular reduce (works)
    let sum = values.reduce((acc, x) => acc + x, 0)
    print($"Regular reduce (sum): {sum}")
    
    let product = values.reduce((acc, x) => acc * x, 1)
    print($"Regular reduce (product): {product}")
    
    print("\n=== Large Array Parallel Map ===")
    let large: [number] = []
    for i in 1..51 {
        large.push(i)
    }
    print($"Large array size: {large.length}")
    
    // Parallel map on large array
    let largeSquared = large.par().map(x => x * x)
    print($"First 5 squared: [{largeSquared[0]}, {largeSquared[1]}, {largeSquared[2]}, {largeSquared[3]}, {largeSquared[4]}]")
    print($"50^2 = {largeSquared[49]}")
    
    print("\nâœ… Parallel map tests complete!")
    print("\nNote: filter lambdas have dereference bug #50")
}
